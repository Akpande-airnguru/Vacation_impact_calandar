/* style.css */

/* 1. THEME & LAYOUT VARIABLES */
:root {
    --bs-body-bg: #f8f9fa;
    --bs-body-color: #212529;
    --bs-border-color: #dee2e6;
    --bs-tertiary-bg: #f8f9fa;
    --card-bg: #ffffff;
    --card-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    --kpi-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    --heatmap-warning-bg: rgba(255, 183, 3, 0.15);
    --heatmap-critical-bg: rgba(217, 4, 41, 0.1);
    --impact-event-dark-bg: #5e666e;
    --status-critical: #d90429;
    --status-warning: #ffb703;
}

[data-bs-theme="dark"] {
    --bs-body-bg: #212529;
    --bs-body-color: #dee2e6;
    --bs-border-color: #495057;
    --bs-tertiary-bg: #343a40;
    --card-bg: #2b3035;
    --card-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
    --kpi-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    --heatmap-warning-bg: rgba(255, 183, 3, 0.25);
    --heatmap-critical-bg: rgba(217, 4, 41, 0.2);
}

body {
    background-color: var(--bs-body-bg);
    color: var(--bs-body-color);
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    transition: background-color 0.3s, color 0.3s;
}

.card {
    border: 1px solid var(--bs-border-color);
    box-shadow: var(--card-shadow);
    background-color: var(--card-bg);
}
.card-header, .modal-header, .modal-footer {
    background-color: var(--bs-body-bg);
    border-bottom: 1px solid var(--bs-border-color);
    border-top: 1px solid var(--bs-border-color);
}
.modal-content {
    background-color: var(--card-bg);
}

/* 2. DASHBOARD & KPI STYLES */
.kpi-card {
    border: none;
    box-shadow: var(--kpi-shadow);
    transition: transform 0.2s ease-in-out;
}
.kpi-card:hover { transform: translateY(-5px); }
.kpi-card .card-body { padding: 1rem; }
.kpi-subtitle { font-size: 0.75rem; opacity: 0.8; }
#issues-chart, #leave-chart { max-height: 125px; }

/* 3. CALENDAR GLOBAL STYLES */
#calendar {
    --fc-border-color: var(--bs-border-color);
    --fc-today-bg-color: rgba(255, 224, 130, 0.15);
}
[data-bs-theme="dark"] #calendar {
    --fc-today-bg-color: rgba(255, 224, 130, 0.1);
}
.fc .fc-button-primary { background-color: #0d6efd; border-color: #0d6efd; }
.fc .fc-daygrid-day.fc-day-today { background-color: var(--fc-today-bg-color); }
.fc .fc-daygrid-day.day-bg-warning { background-color: var(--heatmap-warning-bg); }
.fc .fc-daygrid-day.day-bg-critical { background-color: var(--heatmap-critical-bg); }

/* 4. MONTH VIEW EVENT STYLES (REVAMPED) */
.fc-daygrid-event {
    border-radius: 4px; margin-bottom: 3px; padding: 3px 6px;
    font-size: 0.8em; font-weight: 500;
    overflow: hidden; white-space: nowrap; text-overflow: ellipsis;
}
/* Impact Event Styling (Critical/Warning) */
.fc-event.impact-event {
    border: 1px solid rgba(0,0,0,0.2);
    border-left-width: 4px;
    background-color: var(--bs-tertiary-bg);
}
[data-bs-theme="dark"] .fc-event.impact-event {
    background-color: var(--impact-event-dark-bg); /* Use a distinct dark color */
    border-color: rgba(255,255,255,0.2);
}
.fc-event.impact-critical { border-left-color: var(--status-critical); }
.fc-event.impact-warning { border-left-color: var(--status-warning); }
.fc-event.impact-event .fc-event-title {
    color: var(--bs-body-color) !important;
    font-weight: 600;
    display: flex;
    align-items: center;
}
.fc-event.impact-event .bi {
    font-size: 0.9em;
    margin-right: 5px;
}

/* Leave Event Styling */
.fc-event.vacation-event, .fc-event.holiday-event {
    font-weight: 500;
}
[data-bs-theme="dark"] .fc-event.vacation-event { background-color: #004085; color: #e6f3ff; border: 1px solid #004085;}
[data-bs-theme="dark"] .fc-event.holiday-event { background-color: #155724; color: #e9f5e9; border: 1px solid #155724;}

/* 5. LIST VIEW STYLES */
.fc .fc-list-day-cushion { background-color: rgba(128,128,128,0.1); }
.fc-list-event { background-color: var(--card-bg); border: 1px solid var(--bs-border-color); }
.fc-list-event .fc-event-title-main.impact-critical { color: var(--status-critical); }
.fc-list-event .fc-event-title-main.impact-warning { color: var(--status-warning); }

/* 6. LOADING SPINNER & TOOLTIPS */
.spinner-overlay {
    position: absolute; top: 0; left: 0; right: 0; bottom: 0;
    background-color: rgba(255, 255, 255, 0.7); z-index: 100;
    display: flex; justify-content: center; align-items: center;
    visibility: hidden; opacity: 0; transition: opacity 0.3s, visibility 0.3s;
}
[data-bs-theme="dark"] .spinner-overlay { background-color: rgba(33, 37, 41, 0.7); }
.spinner-overlay.visible { visibility: visible; opacity: 1; }

/* *** FIX: Tooltip z-index issue *** */
.tooltip {
    z-index: 1100 !important; /* Higher than FullCalendar's popover (101) and Bootstrap modals (1055) */
}
.tooltip-inner { 
    white-space: pre-wrap; 
    text-align: left; 
    max-width: 400px; 
}
